---
- name: Play for setting up my-macos-setup
  hosts: all

  pre_tasks:
    - name: Add /usr/local/sbin to path
      ansible.builtin.lineinfile:
        path: /etc/paths
        line: '/usr/local/sbin'
        insertbefore: '/usr/sbin'
      become: true

    - name: Update hostname
      ansible.builtin.hostname:
        name: "{{ ansible_user_id }}-mac"
      become: true

  roles:

    - homebrew
    - source-control
    - docker
    - python
    - cli-tools
    - vim
    - system
    - java
    - gradle
    - maven
    - node
    - clojure
    - golang
    - kotlin
    - ruby
    - flutter
    - android
    - office
    - plantuml
    - semgrep
    - security
    - internet
    - infrastructure-as-code
    - media
    - claude-code
    - codex

  post_tasks:

    - name: Change .local ownership and permissions
      ansible.builtin.file:
        path: "{{ homebrew_brew_path.stdout | trim }}/share"
        owner: "{{ ansible_user_id }}"
        recurse: true
        mode: '0755'
      become: true
